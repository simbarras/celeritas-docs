%%---------------------------------------------------------------------------%%
% io.tex
%%---------------------------------------------------------------------------%%
\section{User-interface and \ac{io}}

The key challenge in providing user interfaces is developing a framework that
supports integration into existing experimental \ac{mc} simulation sequences
that \ipl{1} provides the minimum required code barrier for incorporation and
\ipl{2} preserves performance.  Existing experimental frameworks are built on
the Geant4 toolkit, which provides user actions that allow users to control the
program and data flow at the level of run, event, track, and step. In Geant4
scoring is done using dedicated stepping actions in which information from the
sensitive detector volumes is accessible through callback semantics into these
parts of the simulation.  This approach provides great user flexibility at the
cost of higher computational overhead and increased system complexity.
Furthermore, callback functions will not work in accelerator code because it is
not possible to call host functions in the middle of device kernel execution.

\celeritas will not operate as a toolkit as Geant4 does, since this would leave
many implementation decisions to the end-user, hindering performance. Therefore,
to address the purely technical challenges of supporting experimental workflows,
we will implement an \ac{api} through which clients can specify geometric
regions for scoring and \ac{mc} particle data. Using this \ac{api} the desired
scoring data can be processed on the host at runtime, and the necessary data
fields for tallies can then be configured for execution in kernel code on the
device.  The most efficient interface would fully occupy the device by executing
many events concurrently.  However, this is not the way that experimental
workflows are currently configured, in which events are executed independently
on each thread.

\celcomment{describe rapids io work}
